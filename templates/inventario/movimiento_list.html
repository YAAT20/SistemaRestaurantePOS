{% extends 'base.html' %}
{% block title %}Movimientos de Inventario{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
    <h2>üìä Movimientos de Inventario</h2>
    <a href="{% url 'inventario:producto_list' %}" class="btn btn-secondary">‚¨ÖÔ∏è Volver</a>
</div>

<table class="table table-sm table-hover align-middle">
    <thead class="table-light">
        <tr>
            <th>Fecha</th>
            <th>Tipo</th>
            <th>Detalle</th>
            <th>Cantidad</th>
            <th>Usuario</th>
            <th>Pedido</th>  <!-- üëà -->
            <th>Descripci√≥n</th>
        </tr>
    </thead>
    <tbody>
        {% for m in movimientos %}
        <tr class="{% if m.tipo == 'entrada' %}table-success{% else %}table-danger{% endif %}">
            <td>{{ m.fecha|date:"d/m/Y H:i" }}</td>
            <td>
                {% if m.tipo == 'entrada' %}
                    <span class="badge bg-success">{{ m.get_tipo_display }}</span>
                {% else %}
                    <span class="badge bg-danger">{{ m.get_tipo_display }}</span>
                {% endif %}
            </td>
            <td>
                {% if m.es_producto %}
                    {{ m.producto.nombre }}
                {% elif m.es_plato %}
                    {{ m.plato.nombre }}
                {% else %}
                    ‚Äî
                {% endif %}
            </td>
            <td>
                {{ m.cantidad }}
                {% if m.producto %} {{ m.producto.unidad_medida }}{% endif %}
            </td>
            <td>{{ m.usuario|default:"Sistema" }}</td>
            <td>
                {% if m.pedido %}
                    <span class="badge bg-info">#{{ m.pedido.numero_diario }}</span>
                {% else %}
                    ‚Äî
                {% endif %}
            </td>
            <td>{{ m.descripcion|default:"‚Äî" }}</td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="7" class="text-center text-muted">No hay movimientos registrados</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}
